<!DOCTYPE html>
<html>
<head>
<title>Test Back4App</title>
<!-- This is the minified production version of Parse JS -->
  <script type="text/javascript" src="https://npmcdn.com/parse/dist/parse.min.js"></script>
  
</head>
<body>

<h1>JS SDK</h1>
<input id="username" type="text" placeholder="Username"/>
<input id="email" type="email" placeholder="Email"/>
<input id="password" type="password" placeholder="Password" />
<button id="createButton">Create User</button>

<h1>-------------------------</h1>
<input id="objId" type="text" placeholder="ObjectId"/>
<button id="searchByObjId">SearchByObjId</button>

<h1>-------------------------</h1>
<h1>File Upload</h1>
<input type="file" id="userCsvFile">
<button id="upload">Upload</button>

</body>
<script type="text/javascript">
// Initialize Parse
  Parse.initialize("pNWxjrix1cu6IokwslWDmklCfdl6X8obnLnTp9bY", "eojW3E0kI37lFyuS7ODP2yPyfgezOZwamVmJGSJZ"); 
  Parse.serverURL = "https://parseapi.back4app.com/";
  // Create a new User
async function createParseUser() {

  // Creates a new Parse "User" object, which is created by default in your Parse app
  let user = new Parse.User();
  // Set the input values to the new "User" object
  user.set("username", document.getElementById("username").value);
  user.set("email", document.getElementById("email").value);
  user.set("password", document.getElementById("password").value);
  try {
    // Call the save method, which returns the saved object if successful
    user = await user.save();
    if (user !== null) {
      // Notify the success by getting the attributes from the "User" object, by using the get method (the id attribute needs to be accessed directly, though)
      alert(
        `New object created with success! ObjectId: ${
          user.id
        }, ${user.get("username")}`
      );
    }
  } catch (error) {
    alert(`Error: ${error.message}`);
  }
}

async function getUserByObjId() {
   var user = Parse.Object.extend("User");
   var query = new Parse.Query(user);
   query.get(document.getElementById("objId").value)
.then((userData) => {

  alert(JSON.stringify(userData));
}, (error) => {
  alert(error);
});
}



async function saveUserCsv() {

const fileUploadControl = document.getElementById("userCsvFile");
   if (fileUploadControl.files.length > 0) {
   alert("aaya");
  const file = fileUploadControl.files[0];
  const name = "user1.txt";

  const parseFile = new Parse.File(name, file);
  parseFile.save().then(function() {
  alert("File uploaded successfully");
}, function(error) {
  alert(error);
});
}
}

// Add on click listener to call the create parse user function
document.getElementById("createButton").addEventListener("click", async function () {
  createParseUser();
});
document.getElementById("searchByObjId").addEventListener("click", async function () {
  getUserByObjId();
});
document.getElementById("upload").addEventListener("click", async function () {
  saveUserCsv();
});
  </script>
</html>